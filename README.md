# LDTC Hello-World  

<p align="center">
  <img src="docs/assets/ldtc-logo.png" alt="LDTC logo" width="360" />
</p>

<!--[DOI badge placeholder; update after Zenodo archive]-->

![DOI](https://img.shields.io/badge/DOI-pending-blue)

A single-machine, real-time “digital boundary organism” that exercises the **Loop-Dominance** NC1/SC1 pipeline with Δt governance, partitioning, Ω perturbations, refusal semantics, an enclave-like LREG, and device-signed indicators.

This repo is a **verification harness**, not a claim of biological consciousness. It validates the **measurement & attestation path** that your paper/patent specifies.

## Features

- Fixed-interval scheduler (Δt) with jitter metrics and audit
- Software **plant** with Energy/Temperature/Repair states + external Exchange signals
- Dual estimators (linear lagged “Granger-like” + kNN mutual information)
- C/Ex partition manager (seeded with hysteresis)
- Guardrails: LREG enclave, hash-chained audit, simple smell-tests
- Ω battery: power-sag, ingress flood, command conflict (refusal semantics)
- Device-signed **indicators** (NC1 bit, SC1 bit, Mq) as CBOR + JSONL
- CLI to run baseline NC1 and Ω→SC1; reporting utilities for figures/tables
- Tests for core pieces

## Quickstart

```bash
# 1) Install
make install

# 2) Generate signing keys
make keys

# 3) Run baseline NC1 loop
make run

# 4) Run an Ω power-sag trial with SC1 evaluation
make omega

# 5) View exported indicators (JSONL)
python scripts/export_indicators.py
```

### Pinned environments

Exact versions used to generate the included artifacts/figures are pinned. To reproduce:

```bash
# Runtime (repro artifacts/figures)
pip install -r requirements.txt

# Dev tooling (tests, lint, typing, notebooks)
pip install -r requirements-dev.txt
```

Artifacts appear under `artifacts/`:

- `artifacts/audits/audit.jsonl` — hash-chained audit records
- `artifacts/indicators/` — device-signed indicator packets (CBOR + JSONL)
- `artifacts/figures/` — plots/tables generated by `ldtc.reporting`

## Configuration

See `configs/`. The R0 profile sets default thresholds/Δt. You can make a calibrated R* profile by copying and tweaking `profile_rstar.example.yml`.

Key fields:

- `dt`: scheduler interval in seconds (default 0.01)
- `window_sec`: measurement window length (default 0.2)
- `method`: `"linear"` or `"mi"`
- `Mmin_db`: NC1 threshold in dB
- `epsilon`, `tau_max`: SC1 thresholds
- `baseline_sec`: duration for the baseline CLI command

## CLI

```bash
python -m ldtc.cli.main run --config configs/profile_r0.yml
python -m ldtc.cli.main omega-power-sag --config configs/profile_r0.yml --drop 0.35 --duration 8
```

### Hardware-in-the-loop (optional)

Configure a profile to select the hardware adapter and UDP telemetry:

```yaml
# in configs/profile_r0.yml (example)
plant:
  adapter: hardware        # or "sim" (default)
  transport: udp           # or "serial" (requires pyserial)
  udp_bind_host: 0.0.0.0
  udp_bind_port: 5005
  # Optional control channel to send actions/omega back to device
  # udp_control_host: 127.0.0.1
  # udp_control_port: 5006
  telemetry_timeout_sec: 2.0
```

Send telemetry as JSON over UDP with keys `E,T,R,demand,io,H` in [0,1]. Example:

```python
import socket, json
sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock.sendto(json.dumps({"E":0.6,"T":0.3,"R":0.9,"demand":0.2,"io":0.1,"H":0.015}).encode(), ("127.0.0.1", 5005))
```

The CLI ingests these values through the same LREG/Ω/attestation path.

## Indicators (what leaves the enclave)

- `nc1` (1b), `sc1` (1b), `mq` (6b), `counter` (u64), `profile_id` (u8), `audit_prev_hash` (sha256)
- Signed using Ed25519 over the CBOR payload

See `docs/INDICATORS.md` for the bit layout and schema.

## Development

```bash
make dev     # optional dev deps
make test
```

## License
MIT — see LICENSE.

## Docker (clean Linux repro)

```bash
# Build the image
make docker-build

# Run baseline NC1 loop inside the container (artifacts mapped to host)
make docker-run

# Or run any CLI subcommand, e.g., an Ω power-sag trial
docker run --rm \
  -v $(pwd)/artifacts:/app/artifacts \
  ldtc-hello-world:latest omega-power-sag --config configs/profile_r0.yml --drop 0.35 --duration 8
```

Notes:
- Artifacts are persisted to your host `artifacts/` via a bind mount.
- The container uses the `ldtc` entrypoint; pass subcommands/flags after the image name.
